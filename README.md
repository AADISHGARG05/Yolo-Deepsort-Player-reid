# Player Re-Identification System

This project implements a player re-identification and tracking system for soccer (football) videos. It leverages YOLOv11 for robust player detection and integrates DeepSORT for multi-object tracking, enhanced with a custom re-identification logic to improve track continuity and accurately count unique players even after temporary occlusions or exits from the frame.

The primary objective of this system is to accurately track and count unique players within a 15-second video segment, demonstrating the effectiveness of combining state-of-the-art object detection with advanced tracking algorithms.

## Features

* **YOLOv11 Player Detection**: Utilizes a fine-tuned YOLOv11 model (`best.pt`) for accurate and efficient player detection in each frame.
* **DeepSORT Tracking**: Employs the DeepSORT algorithm for robust multi-object tracking, assigning unique IDs to detected players.
* **Custom Re-Identification Logic**: Includes a custom re-ID mechanism based on IOU (Intersection Over Union) and centroid distance to re-associate lost tracks with new detections, minimizing ID switches.
* **Unique Player Counting**: Maintains a count of unique players identified throughout the video, providing a stable count even with complex player movements.
* **Real-time Visualization**: Displays bounding boxes, player IDs, and the total unique player count on the video frames during processing.
* **Configurable Parameters**: Easily adjust detection confidence, bounding box area thresholds, and tracking parameters.

## How it Works

1.  **Video Capture**: The system reads the input video frame by frame.
2.  **Object Detection (YOLOv11)**: For each frame, YOLOv11 detects potential players, providing bounding box coordinates, confidence scores, and class IDs.
3.  **Detection Filtering**: Detections are filtered based on confidence thresholds and minimum bounding box area to remove noise and less reliable detections.
4.  **Tracking (DeepSORT)**: Valid detections are fed into the DeepSORT tracker, which assigns unique IDs to continuous player trajectories. DeepSORT uses appearance features and motion to maintain tracks.
5.  **Custom Re-ID**: When a track is lost (e.g., player goes off-screen or is occluded), its information (last known bounding box, centroid, and frame number) is stored in a buffer. New detections are checked against this buffer using IOU and distance metrics. If a strong match is found within a defined `REID_FRAME_TOLERANCE`, the new detection is reassigned the ID of the lost track, ensuring continuity.
6.  **Unique Player Counting**: A set `unique_ids` stores all confirmed unique player IDs observed throughout the video, ensuring that each player is counted only once, even if they reappear after being lost.
7.  **Output Generation**: The processed frames, with bounding boxes, player IDs, and the unique player count, are written to an output video file.

## Project Structure

* `15sec_input_720p.mp4`: The input video file used for testing the system.
* `Final_Project_File.py`: The main Python script containing the entire re-identification and tracking logic.
* `best.pt`: The trained YOLOv11 model weights, specifically fine-tuned for player detection.
* `output_final.mp4`: The output video file generated by the script, showing the tracking results.

## Setup and Installation

1.  **Clone the Repository**:
    ```bash
    git clone [https://github.com/your_username/your_repository_name.git](https://github.com/your_username/your_repository_name.git)
    cd your_repository_name
    ```
    *(Note: Replace `your_username` and `your_repository_name` with your actual GitHub details.)*

2.  **Create a Virtual Environment (Recommended)**:
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows: `venv\Scripts\activate`
    ```

3.  **Install Dependencies**:
    ```bash
    pip install opencv-python ultralytics deep-sort-realtime numpy
    ```

## Usage

To run the player re-identification system, simply execute the main Python script:

```bash
python Final_Project_File.py
